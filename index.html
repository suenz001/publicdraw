<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å­©å­çå‹µæŠ½æŠ½æ¨‚ (å…¬çœ¾ç‰ˆ)</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #2c3e50;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            flex-direction: column;
            padding: 10px;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        .container {
            background: #34495e;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }
        h1 { margin: 0 0 15px 0; font-size: 24px;}
        
        .odds-table {
            width: 100%;
            margin: 10px 0;
            font-size: 13px;
            color: #bdc3c7;
            border-collapse: collapse;
        }
        .odds-table td { padding: 4px; border-bottom: 1px solid #46607a; }
        
        button {
            border: none;
            padding: 15px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            touch-action: manipulation;
        }
        .btn-draw { background-color: #f1c40f; color: #2c3e50; box-shadow: 0 4px 0 #d4ac0d; }
        .btn-draw:active { transform: translateY(4px); box-shadow: none; }
        .btn-draw:disabled { background-color: #95a5a6; box-shadow: none; cursor: not-allowed; }

        #result-card {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            min-height: 80px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .tier-label { font-size: 18px; opacity: 0.9; margin-bottom: 5px; }
        .reward-text { font-size: 24px; font-weight: bold; line-height: 1.3; }

        .rank-common { background: #ecf0f1; color: #7f8c8d; border: 2px solid #bdc3c7; text-shadow: none; }
        .rank-uncommon { background: #2ecc71; color: white; border: 2px solid #27ae60; box-shadow: 0 0 10px #2ecc71; }
        .rank-rare { background: #3498db; color: white; border: 2px solid #2980b9; box-shadow: 0 0 15px #3498db; }
        .rank-epic { background: #9b59b6; color: white; border: 2px solid #8e44ad; box-shadow: 0 0 20px #9b59b6; }
        .rank-legendary { background: #e67e22; color: white; border: 2px solid #d35400; box-shadow: 0 0 25px #e67e22, 0 0 50px #e67e22; }
        .rank-mythic { background: #e74c3c; color: white; border: 2px solid #c0392b; box-shadow: 0 0 30px #e74c3c, 0 0 60px #e74c3c, inset 0 0 20px white; animation: pulse 1s infinite; }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .history {
            margin-top: 20px;
            font-size: 13px;
            color: #95a5a6;
            max-height: 150px;
            overflow-y: auto;
            text-align: left;
            border-top: 1px solid #46607a;
            padding-top: 10px;
        }
        .history div { margin-bottom: 5px; border-bottom: 1px dashed #46607a; padding-bottom: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ å­©å­çå‹µæŠ½æŠ½æ¨‚</h1>
    
    <table class="odds-table">
        <tr><td style="color:#ecf0f1">æ™®é€š (60%)</td><td style="color:#2ecc71">ç½•è¦‹ (20%)</td></tr>
        <tr><td style="color:#3498db">ç¨€æœ‰ (10%)</td><td style="color:#9b59b6">å²è©© (6%)</td></tr>
        <tr><td style="color:#e67e22">å‚³å¥‡ (3%)</td><td style="color:#e74c3c; font-weight:bold;">ç¥è©± (1%)</td></tr>
    </table>

    <div id="result-card" style="display:none;">
        <div class="tier-label"></div>
        <div class="reward-text"></div>
    </div>
    
    <button id="drawBtn" class="btn-draw" onclick="draw()">ğŸš€ è©¦æ‰‹æ°£</button>

    <div class="history" id="historyLog">
        æœ¬å±€ç´€éŒ„ï¼š
    </div>
</div>

<script>
    // å®šç¾©çé …èˆ‡æ©Ÿç‡
    const tiers = [
        { 
            name: 'æ™®é€š', 
            class: 'rank-common', 
            probability: 60, 
            colorCode: '#ecf0f1',
            confetti: false,
            rewards: ['å°æ—¥è¨˜æ¸›å°‘ä¸€è¡Œ','å‡æ—¥ç©é›»å‹•åŠ 5åˆ†é˜','å‡æ—¥çˆ¸çˆ¸é™ªç©é›»å‹•5åˆ†é˜','æ¸›å°‘çœ‹æ›¸æ™‚é–“5åˆ†é˜']
        },
        { 
            name: 'ç½•è¦‹', 
            class: 'rank-uncommon', 
            probability: 20, 
            colorCode: '#2ecc71',
            confetti: false,
            rewards: ['å°æ—¥è¨˜æ¸›å°‘äºŒè¡Œ','å‡æ—¥ç©é›»å‹•åŠ 10åˆ†é˜','å‡æ—¥çˆ¸çˆ¸é™ªç©é›»å‹•10åˆ†é˜','æ¸›å°‘çœ‹æ›¸æ™‚é–“10åˆ†é˜']
        },
        { 
            name: 'ç¨€æœ‰', 
            class: 'rank-rare', 
            probability: 10, 
            colorCode: '#3498db',
            confetti: true, // å½©å¸¶ç‰¹æ•ˆ
            rewards: ['å°æ—¥è¨˜æ¸›å°‘ä¸‰è¡Œ','å‡æ—¥ç©é›»å‹•åŠ 15åˆ†é˜','å‡æ—¥çˆ¸çˆ¸é™ªç©é›»å‹•15åˆ†é˜','æ¸›å°‘çœ‹æ›¸æ™‚é–“15åˆ†é˜','åª½åª½é™ªç¡è¦º']
        },
        { 
            name: 'å²è©©', 
            class: 'rank-epic', 
            probability: 6, 
            colorCode: '#9b59b6',
            confetti: true,
            rewards: ['å°æ—¥è¨˜æ¸›å°‘å››è¡Œ','å¹³æ—¥å¯ç©é›»å‹•10åˆ†é˜','å‡æ—¥çˆ¸çˆ¸é™ªç©é›»å‹•15åˆ†é˜']
        },
        { 
            name: 'å‚³å¥‡', 
            class: 'rank-legendary', 
            probability: 3, 
            colorCode: '#e67e22',
            confetti: true,
            rewards: ['å¹³æ—¥å¯ç©é›»å‹•15åˆ†é˜','é›¶ç”¨éŒ¢100å…ƒ']
        },
        { 
            name: 'ç¥è©±', 
            class: 'rank-mythic', 
            probability: 1, 
            colorCode: '#e74c3c',
            confetti: true,
            rewards: ['å¹³æ—¥å¯ç©é›»å‹•30åˆ†é˜','å¯ä»»æ„é¸è³¼500å…ƒå…§çš„å°ç¦®ç‰©']
        }
    ];

    function draw() {
        const btn = document.getElementById('drawBtn');
        const card = document.getElementById('result-card');
        const tierLabel = card.querySelector('.tier-label');
        const rewardText = card.querySelector('.reward-text');
        
        // é–å®šæŒ‰éˆ•
        btn.disabled = true;
        
        // é¡¯ç¤ºå¡ç‰‡ä¸¦åˆå§‹åŒ–
        card.style.display = 'flex';
        card.className = '';
        card.style.backgroundColor = '#34495e';
        
        tierLabel.innerText = "ğŸ²";
        tierLabel.style.fontSize = "30px";
        rewardText.innerText = "æŠ½é¸ä¸­...";
        rewardText.style.fontSize = "16px";
        
        // é–ƒçˆå‹•ç•«
        let flashCount = 0;
        const flashInterval = setInterval(() => {
            const randomTier = tiers[Math.floor(Math.random() * tiers.length)];
            card.style.color = randomTier.colorCode; 
            flashCount++;
            
            if (flashCount > 10) { 
                clearInterval(flashInterval);
                finishDraw(card, btn);
            }
        }, 80);
    }

    function finishDraw(card, btn) {
        // 1. æ±ºå®šç¨€æœ‰åº¦
        const rand = Math.random() * 100;
        let cumulative = 0;
        let selectedTier = null;

        for (let tier of tiers) {
            cumulative += tier.probability;
            if (rand < cumulative) {
                selectedTier = tier;
                break;
            }
        }
        if (!selectedTier) selectedTier = tiers[0];

        // 2. æ±ºå®šå…·é«”çå‹µ
        const randomReward = selectedTier.rewards[Math.floor(Math.random() * selectedTier.rewards.length)];

        // 3. é¡¯ç¤ºçµæœ
        card.style.color = '';
        card.className = selectedTier.class;
        
        const tierLabel = card.querySelector('.tier-label');
        const rewardText = card.querySelector('.reward-text');
        
        tierLabel.innerText = selectedTier.name;
        tierLabel.style.fontSize = "18px";
        rewardText.innerText = randomReward;
        rewardText.style.fontSize = "26px";

        // 4. è§¸ç™¼ç‰¹æ•ˆ
        if (selectedTier.confetti) {
            triggerConfetti();
        }

        // 5. å¯«å…¥ç•«é¢ç´€éŒ„
        const history = document.getElementById('historyLog');
        const p = document.createElement('div');
        const timeStr = new Date().toLocaleTimeString();
        // ç§»é™¤äº‹ç”±ï¼Œåªé¡¯ç¤ºæ™‚é–“å’Œçé …
        p.innerHTML = `<span style="color:#bdc3c7">[${timeStr}]</span> <span style="color:${selectedTier.colorCode}">${selectedTier.name} - ${randomReward}</span>`;
        history.insertBefore(p, history.children[0].nextSibling); // æ’åœ¨æ¨™é¡Œä¸‹æ–¹

        // 6. è§£é–æŒ‰éˆ•
        btn.disabled = false;
        btn.innerText = "ğŸ”„ å†æŠ½ä¸€æ¬¡";
    }

    // å½©å¸¶ç‰¹æ•ˆ
    function triggerConfetti() {
        var count = 200;
        var defaults = { origin: { y: 0.7 } };

        function fire(particleRatio, opts) {
            confetti(Object.assign({}, defaults, opts, {
                particleCount: Math.floor(count * particleRatio)
            }));
        }

        fire(0.25, { spread: 26, startVelocity: 55, });
        fire(0.2, { spread: 60, });
        fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
        fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
        fire(0.1, { spread: 120, startVelocity: 45, });
    }
</script>

</body>
</html>